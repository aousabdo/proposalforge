## High-Level System Architecture

The ProposalForge system consists of the following major components:

```
+-----------------------------------------------------------------------------------+
|                        ProposalForge System Architecture                          |
+----------------+--------------------------------------------+--------------------+
|                |                                            |                    |
|                v                                            v                    v
|    +-------------------+                          +------------------+  +----------------+
|    |   Web Frontend    |                          | Backend Services |  |  Auth Service  |
|    |  (React + Vite)   |<------------------------->|   (Express.js)   |  |    (Clerk)     |
|    +-------------------+                          +------------------+  +----------------+
|                |                                            |                    ^
|                |                                            |                    |
|                v                                            v                    |
|    +-------------------+                          +------------------+           |
|    |   API Gateway     |<------------------------->| Service Registry |           |
|    +-------------------+                          +------------------+           |
|                |                                                                 |
|                |                                                                 |
|                v                                                                 |
|    +------------------------------------------------------------------------------------+ |
|    |                                                                                    | |
|    |  +--------------+   +--------------+   +--------------+                            | |
|    |  |  Document    |   |  Proposal    |   |  Knowledge   |                            | |
|    |  |  Service     |   |  Service     |   | Base Service |                            | |
|    |  +--------------+   +--------------+   +--------------+                            | |
|    |        |                 |                    |                                    | |
|    |        v                 v                    v                                    | |
|    |  +--------------+   +--------------+   +--------------+                            | |
|    |  |  AI Service  |   |  Analytics   |   |   Export     |                            | |
|    |  |  (LLM)       |   |  Service     |   |   Service    |                            | |
|    |  +--------------+   +--------------+   +--------------+                            | |
|    |                                                                                    | |
|    +------------------------------------------------------------------------------------+ |
|                                                                                           |
+-------------------------------------------------------------------------------------------+

+-------------------------------------------------------------------------------------------+
|                                     Data Layer                                            |
|                                                                                           |
|   +-------------+    +-------------+    +-------------+    +-------------+                |
|   | PostgreSQL  |    |   Qdrant    |    |     S3      |    |    Redis    |                |
|   |   (RDS)     |    | (Vector DB) |    |  (Document  |    |   (Cache)   |                |
|   |             |    |             |    |   Storage)  |    |             |                |
|   +-------------+    +-------------+    +-------------+    +-------------+                |
|                                                                                           |
+-------------------------------------------------------------------------------------------+
```

### Component Descriptions

### 1. Document Upload and Processing Flow

```
+-------------+     +-------------+     +-------------+     +-------------+
|             |     |             |     |             |     |             |
|  Frontend   |---->|  Document   |---->|     S3      |---->|   Agno AI   |
|             |     |   Service   |     |             |     |             |
+-------------+     +-------------+     +-------------+     +-------------+
                         |                                       |
                         |                                       v
                         |                                 +-------------+
                         |                                 |             |
                         +-------------------------------->|   Qdrant    |
                                                           |             |
                                                           +-------------+
```

1. User uploads document via frontend

### 2. Outline Generation Flow

```
+------------+     +---------------+     +---------------+     +------------+
|            |     |               |     |               |     |            |
|  Frontend  |---->|   Proposal    |---->|   Document    |---->|   Qdrant   |
|            |     |   Service     |     |   Service     |     |            |
+------------+     +---------------+     +---------------+     +------------+
                         |                                          |
                         v                                          |
                   +------------+                                   |
                   |            |                                   |
                   | AI Service |<----------------------------------+
                   |            |
                   +------------+
                         |
                         v
                   +------------+
                   |            |
                   | PostgreSQL |
                   |            |
                   +------------+
```

1. User requests outline generation via frontend

### 3. Collaborative Editing Flow (Enterprise)

```
+---------------+     +----------------+     +--------------+
|               |     |                |     |              |
| Frontend A    |---->|    Proposal    |---->|  PostgreSQL  |
| (User A)      |     |    Service     |     |              |
+---------------+     +----------------+     +--------------+
                             |                      |
                             v                      |
                     +----------------+             |
                     |                |             |
                     |   Websocket    |             |
                     |   Server       |             |
                     +----------------+             |
                             |                      |
                             v                      v
                     +----------------+     +--------------+
                     |                |     |              |
                     | Frontend B     |     |   Feature    |
                     | (User B)       |     |   Flags      |
                     +----------------+     +--------------+
```

1. User A makes edits to a proposal section

### 4. Authentication Flow

```
+------------+     +-------------+     +------------+
|            |     |             |     |            |
|  Frontend  |---->|    Auth     |---->|   Clerk    |
|            |     |   Service   |     |            |
+------------+     +-------------+     +------------+
                         |                  |
                         v                  |
                   +-------------+          |
                   |             |          |
                   |    API      |<---------+
                   |   Gateway   |
                   +-------------+
                         |
                         v
                   +-------------+
                   |             |
                   |   Backend   |
                   |   Services  |
                   +-------------+
```

1. User initiates login via frontend

## Feature Flag Architecture

The feature flag system enables progressive activation of Enterprise features:

```
+------------+     +-----------------+     +------------+
|            |     |                 |     |            |
|  Frontend  |---->|     Feature     |---->| PostgreSQL |
|            |     |     Service     |     |            |
+------------+     +-----------------+     +------------+
                           |
                           v
                   +-----------------+
                   |                 |
                   |     Backend     |
                   |     Services    |
                   +-----------------+
```

- Feature flags are stored in PostgreSQL

## Deployment Architecture

ProposalForge is deployed on AWS with the following architecture:

```
+-------------------------------------------------------------------------------------------+
|                                     AWS                                               |
|                                                                                       |
| +------------+     +------------+      +------------+      +------------+             |
| | CloudFront |---->|    S3      |      |    ALB     |      |  Route53   |             |
| |            |     | (Frontend) |      |            |<-----|            |             |
| +------------+     +------------+      +------------+      +------------+             |
|                                              |                                        |
|                                              v                                        |
|                                       +------------+                                  |
|                                       |    EC2     |                                  |
|                                       | (Autoscale)|                                  |
|                                       +------------+                                  |
|                                              |                                        |
|      +------------+                          |                                        |
|      |    S3      |<-------------------------+                                        |
|      | (Documents)|                          |                                        |
|      +------------+                          v                                        |
|                                       +------------+     +------------+               |
|                                       |    RDS     |     | ElastiCache|               |
|                                       | (PostgreSQL|     |   (Redis)  |               |
|                                       +------------+     +------------+               |
|                                                                                       |
|      +------------+                  +------------+                                   |
|      |    EC2     |                  |  CloudWatch|                                   |
|      |  (Qdrant)  |                  |            |                                   |
|      +------------+                  +------------+                                   |
|                                                                                       |
+-------------------------------------------------------------------------------------------+
                       |                                 |
                       v                                 v
             +-------------------+           +-------------------+
             |     OpenAI API    |           |     Clerk API     |
             |                   |           |                   |
             +-------------------+           +-------------------+
```

### Development Environment 